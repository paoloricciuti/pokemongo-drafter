(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{25:function(e,t,n){},26:function(e,t,n){},28:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),o=n(18),s=n.n(o),i=(n(25),n(26),n(5)),u=n.n(i),l=n(9),j=n(4),b=n(2),d=function(){return function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a,c,o,s,i,l,j,b,d=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>2&&void 0!==d[2]?d[2]:null,a=!(d.length>3&&void 0!==d[3])||d[3],c="/api/",o=new Headers,a&&o.append("Content-Type","application/json"),s={method:n,body:null!=r&&"GET"!=n?JSON.stringify(r):null,headers:o},r instanceof FormData&&(s.body=r),i="","GET"==n&&null!=r&&(l=new URLSearchParams,Object.entries(r).forEach((function(e){l.append(e[0],e[1])})),i="?".concat(l.toString())),e.next=11,fetch("".concat(c).concat(t).concat(i),s);case 11:return j=e.sent,e.prev=12,e.next=15,j.json();case 15:b=e.sent,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),b={ok:!1};case 21:return e.abrupt("return",b);case 22:case"end":return e.stop()}}),e,null,[[12,18]])})));return function(t,n){return e.apply(this,arguments)}}()},p=(n(28),function(e){var t=Object(a.useState)(""),n=Object(j.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(""),i=Object(j.a)(s,2),p=i[0],h=i[1],O=Object(a.useState)(""),f=Object(j.a)(O,2),m=f[0],x=f[1],v=Object(a.useState)(""),w=Object(j.a)(v,2),k=w[0],g=w[1],y=d(),S=Object(b.f)(),C=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),g(""),x(""),""!=p){e.next=6;break}return g("Password can't be blank"),e.abrupt("return");case 6:if(""!=c){e.next=9;break}return x("Room name can't be blank"),e.abrupt("return");case 9:return e.next=11,y("rooms","POST",{name:c,password:p});case 11:(n=e.sent).error?x("A room with the same name already exists, try another one"):S.push("/joinroom/".concat(n.link),n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{className:"main",children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("h3",{children:"Welcome to Pokemon Go drafter, the definitive tool to create a draft tournament with your friends."}),Object(r.jsx)("p",{class:"explanation",children:"Chose a room name and a password, share the link and the password with friends and start drafting."}),Object(r.jsxs)("form",{onSubmit:C,children:[Object(r.jsx)("input",{placeholder:"Room Name",type:"text",value:c,onChange:function(e){o(e.target.value)}}),""!=m&&Object(r.jsx)("div",{className:"error",children:m}),Object(r.jsx)("input",{placeholder:"Password",type:"password",value:p,onChange:function(e){h(e.target.value)}}),""!=k&&Object(r.jsx)("div",{className:"error",children:k}),Object(r.jsx)("button",{type:"submit",children:"Create Room"})]})]})})}),h=Object(a.createContext)(null),O=Object(a.createContext)(null),f=function(){return Object(a.useContext)(h)},m=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(j.a)(n,2),o=c[0],s=c[1];return Object(r.jsx)(h.Provider,{value:o,children:Object(r.jsx)(O.Provider,{value:s,children:t})})},x=function(e){var t=Object(b.h)().link,n=f(),c=Object(b.f)();return Object(a.useEffect)((function(){null==n&&c.push("/joinroom/".concat(t))}),[n]),n&&Object(r.jsx)("div",{className:"main",children:Object(r.jsx)("div",{className:"container titled","data-title":n.name,children:Object(r.jsx)("ul",{children:n.players.map((function(e){return Object(r.jsxs)("li",{children:[e.username," ",1==e.online?"(Online)":"(Offline)"]},e.username)}))})})})},v=Object(a.createContext)(null),w=Object(a.createContext)(null),k=function(e){var t=e.children,n=Object(a.useState)(window.io()),c=Object(j.a)(n,2),o=c[0],s=c[1],i=Object(a.useContext)(O);return Object(a.useEffect)((function(){o.on("updateRoom",(function(e){i(e)}))}),[i]),Object(r.jsx)(v.Provider,{value:o,children:Object(r.jsx)(w.Provider,{value:s,children:o&&t})})},g=function(e){var t=Object(b.h)().link,n=Object(a.useRef)(),c=Object(b.g)(),o=Object(a.useState)(null),s=Object(j.a)(o,2),i=s[0],p=s[1],h=d(),O=Object(a.useContext)(v),m=Object(a.useState)(""),x=Object(j.a)(m,2),w=x[0],k=x[1],g=Object(a.useState)(""),y=Object(j.a)(g,2),S=y[0],C=y[1],N=Object(a.useState)(""),P=Object(j.a)(N,2),E=P[0],R=P[1],T=Object(a.useState)(""),J=Object(j.a)(T,2),G=J[0],U=J[1],A=Object(a.useState)(""),D=Object(j.a)(A,2),L=D[0],W=D[1],F=Object(a.useState)(""),H=Object(j.a)(F,2),B=H[0],I=H[1],M=Object(b.f)(),$=f(),_=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,c,o,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new TextEncoder,r=n.encode(t),e.next=4,crypto.subtle.digest("SHA-256",r);case 4:for(a=e.sent,c="",o=new Uint8Array(a),s=o.byteLength,i=0;i<s;i++)c+=String.fromCharCode(o[i]);return e.abrupt("return",btoa(c));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText("https://pokemongo-drafter.herokuapp.com/joinroom/".concat(t));case 2:n.current.classList.add("copied");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),W(""),U(""),I(""),e.next=6,_(E);case 6:if(e.t0=e.sent,e.t1=i.password,e.t0==e.t1){e.next=11;break}return I("Wrong room Password"),e.abrupt("return");case 11:if(/^\w+$/.test(w)){e.next=14;break}return U("Username can't contain spaces or special characters and can't be blank"),e.abrupt("return");case 14:if(""!=S){e.next=17;break}return W("Password can't be blank"),e.abrupt("return");case 17:O.emit("joinRoom",{username:w,password:S,room:t});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("rooms/".concat(t),"GET");case 2:n=e.sent,p(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c.state?p(c.state):e(),O.on("wrongPassword",(function(e){W("Wrong password")}))}),[]),Object(a.useEffect)((function(){null!=$&&M.push("/room/".concat($.link))}),[$]),i&&Object(r.jsx)("div",{className:"main",children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("h3",{children:!1!==i.ok?"Joining room ".concat(i.name):"No room with name ".concat(t)}),!(!1===i.ok)&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("p",{className:"explanation",children:["Chose your username and password, you can use them to come back later.",Object(r.jsx)("br",{}),"Share the following link with your friends together with the password to let them join the draft.",Object(r.jsxs)("code",{class:"share-link",onClick:q,children:[Object(r.jsxs)("span",{className:"link",children:["https://pokemongo-drafter.herokuapp.com/joinroom/",t]}),Object(r.jsx)("i",{ref:n,class:"material-icons right",children:"content_copy"})]})]}),Object(r.jsxs)("form",{onSubmit:z,children:[Object(r.jsx)("input",{placeholder:"Username",type:"text",value:w,onChange:function(e){k(e.target.value)}}),""!=G&&Object(r.jsx)("div",{className:"error",children:G}),Object(r.jsx)("input",{placeholder:"Password",type:"password",value:S,onChange:function(e){C(e.target.value)}}),""!=L&&Object(r.jsx)("div",{className:"error",children:L}),Object(r.jsx)("input",{placeholder:"Room Password",type:"password",value:E,onChange:function(e){R(e.target.value)}}),""!=B&&Object(r.jsx)("div",{className:"error",children:B}),Object(r.jsx)("button",{type:"submit",children:"Join"})]})]})]})})},y=n(11);var S=function(){return Object(r.jsx)(y.a,{children:Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{path:"/",exact:!0,component:p}),Object(r.jsx)(b.a,{path:"/room/:link",exact:!0,component:x}),Object(r.jsx)(b.a,{path:"/joinroom/:link",exact:!0,component:g}),Object(r.jsx)(b.a,{path:"/test",exact:!0,children:Object(r.jsx)("div",{children:"Test"})})]})})};s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(m,{children:Object(r.jsx)(k,{children:Object(r.jsx)(S,{})})})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.2c1cc7f7.chunk.js.map